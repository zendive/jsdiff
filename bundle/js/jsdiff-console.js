(()=>{"use strict";const t={EMPTY:"(empty)",UNDEFINED:"(undefined)",NULL:"(null)",NATIVE_FUNCTION:"ƒ(native)",EXCEPTION_FALLBACK:"⁉️(exception)",EXCEPTION:t=>`⁉️(${t})`,RECURRING_ARRAY:t=>`0x${t}: [♻️]`,RECURRING_OBJECT:t=>`0x${t}: {♻️}`,RECURRING_SET:t=>`0x${t}: Set[♻️]`,RECURRING_MAP:t=>`0x${t}: Map{♻️}`,UNSERIALIZABLE:t=>`0x${t}: unserializable`,SYMBOL:(t,n)=>`0x${n}: ${t}`,FUNCTION:(t,n)=>`ƒ${t?` ${t}`:""}(${n})`,NUMERIC:t=>"bigint"==typeof t?`BigInt(${t})`:`Number(${t})`};var n,e,o,i,r=function(t,n,e,o,i){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof n?t!==n||!i:!n.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?i.call(t,e):i?i.value=e:n.set(t,e),e},a=function(t,n,e,o){if("a"===e&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof n?t!==n||!o:!n.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===e?o:"a"===e?o.call(t):o?o.value:n.get(t)};async function s(n,e){try{window.postMessage({source:"jsdiff-console-to-proxy-inprogress",on:!0},window.location.origin);for(const o of["push","left","right"])if(Reflect.has(e,o)){const i=e[o];e[o]=void 0===i?t.UNDEFINED:null===i?t.NULL:await n(i)}window.postMessage({source:"jsdiff-console-to-proxy-compare",payload:e},window.location.origin)}catch(t){console.error("console.diff()",t),window.postMessage({source:"jsdiff-console-to-proxy-inprogress",on:!1},window.location.origin)}}async function c(t){let n=new Set;const e=JSON.parse(JSON.stringify(t,d.bind(null,n)));return n=n.clear(),e}class f{constructor(){n.add(this),e.set(this,void 0),o.set(this,0),r(this,e,new Map,"f")}clear(){a(this,e,"f").clear()}lookup(t,s){var c;let f=a(this,e,"f").get(t);if(!f){r(this,o,(c=a(this,o,"f"),++c),"f");const u=a(this,n,"m",i).call(this,a(this,o,"f"));f={name:I(t)?s(t.toString(),u):s(u),seen:!1},a(this,e,"f").set(t,f)}return f}}async function u(t){let n=new f;const e=await l(n,t);return n.clear(),n=null,e}async function l(n,e){let o=e;if(g(e)){const{name:i}=n.lookup(e,t.UNSERIALIZABLE);o=i}else if(m(e))o=await y(e);else if(I(e)){const{name:i}=n.lookup(e,t.SYMBOL);o=i}else E(e)?o=await p(n,e,t.RECURRING_ARRAY):N(e)?o=await p(n,e,t.RECURRING_SET):h(e)?o=await async function(n,e){const o=n.lookup(e,t.RECURRING_MAP);let i;if(o.seen)i=o.name;else{o.seen=!0;const t={};for(const[o,i]of e){const e=await w(n,o),r=await l(n,i);t[e]=r}i=t}return i}(n,e):A(e)?o=await async function(n,e){const o=n.lookup(e,t.RECURRING_OBJECT);let i;if(o.seen)i=o.name;else if(o.seen=!0,function(t){let n;try{n=null!==t&&"object"==typeof t&&"toJSON"in t&&"function"==typeof t.toJSON}catch(t){n=!1}return n}(e)){const t=function(t){let n;try{n=t.toJSON()}catch(t){n=R(t)}return n}(e);i=await l(n,t)}else{const o={},r=Reflect.ownKeys(e);for(const i of r){let r,a;if(I(i)){const{name:e}=n.lookup(i,t.SYMBOL);r=e}else r=i;try{a=await l(n,e[i])}catch(t){a=R(t)}o[r]=a}i=o}return i}(n,e):!function(t){return"bigint"==typeof t||Number.isNaN(t)||t===-1/0||t===1/0}(e)?function(t){return void 0===t}(e)&&(o=String(e)):o=t.NUMERIC(e);return o}async function p(t,n,e){const o=t.lookup(n,e);let i;if(o.seen)i=o.name;else{o.seen=!0;const e=[];for(const o of n)e.push(await l(t,o));i=e}return i}async function w(n,e){let o;if(g(e)){const{name:i}=n.lookup(e,t.UNSERIALIZABLE);o=i}else if(m(e))o=await y(e);else if(I(e)){const{name:i}=n.lookup(e,t.SYMBOL);o=i}else if(E(e)){const{name:i}=n.lookup(e,t.RECURRING_ARRAY);o=i}else if(N(e)){const{name:i}=n.lookup(e,t.RECURRING_SET);o=i}else if(h(e)){const{name:i}=n.lookup(e,t.RECURRING_MAP);o=i}else if(A(e)){const{name:i}=n.lookup(e,t.RECURRING_OBJECT);o=i}else o=String(e);return o}async function y(n){const e=n.toString();if(e.endsWith("{ [native code] }"))return t.NATIVE_FUNCTION;{const o=await async function(t){const n=(new TextEncoder).encode(t),e=await window.crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(e)).map((t=>t.toString(16).padStart(2,"0").toUpperCase())).join("")}(e);return t.FUNCTION(n.name,o)}}function R(n){return"function"==typeof n?.toString?t.EXCEPTION(n.toString()):t.EXCEPTION_FALLBACK}function d(t,n,e){try{if(g(e))return;if(m(e))return e.toString();if(A(e)){if(t.has(e))return;t.add(e)}return e}catch(t){return R(t)}}function E(t){return t instanceof Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof BigUint64Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof BigInt64Array||t instanceof Float32Array||t instanceof Float64Array}function m(t){return"function"==typeof t&&"toString"in t&&"function"==typeof t.toString}function N(t){return t instanceof Set}function h(t){return t instanceof Map}function g(t){return t instanceof Element||t instanceof Document}function I(t){return"symbol"==typeof t}function A(t){return null!==t&&"object"==typeof t||t instanceof Object}e=new WeakMap,o=new WeakMap,n=new WeakSet,i=function(t){return t.toString(16).padStart(4,"0")},Object.assign(console,{diff:(...t)=>{s(u,1===t.length?{push:t[0],timestamp:Date.now()}:{left:t[0],right:t[1],timestamp:Date.now()})},diffLeft:t=>{s(u,{left:t,timestamp:Date.now()})},diffRight:t=>{s(u,{right:t,timestamp:Date.now()})},diffPush:t=>{s(u,{push:t,timestamp:Date.now()})},diff_:(...t)=>{s(c,1===t.length?{push:t[0],timestamp:Date.now()}:{left:t[0],right:t[1],timestamp:Date.now()})}}),console.debug("✚ console.diff()")})();