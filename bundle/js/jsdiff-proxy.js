(()=>{"use strict";var d={};const n={EMPTY:"\u27EAempty\u27EB",UNDEFINED:"\u27EAundefined\u27EB",NULL:"\u27EAnull\u27EB",NATIVE_FUNCTION:"\u0192\u27EAnative\u27EB",EXCEPTION_FALLBACK:"\u2049\uFE0F \u27EAexception\u27EB",EXCEPTION:e=>`\u2049\uFE0F \u27EA${e}\u27EB`,RECURRING_ARRAY:e=>`0x${e}: [\u267B\uFE0F]`,RECURRING_OBJECT:e=>`0x${e}: {\u267B\uFE0F}`,RECURRING_SET:e=>`0x${e}: Set[\u267B\uFE0F]`,RECURRING_MAP:e=>`0x${e}: Map{\u267B\uFE0F}`,UNSERIALIZABLE:e=>`0x${e}: \u27EAunserializable\u27EB`,SYMBOL:(e,o)=>`0x${o}: ${e}`,FUNCTION:(e,o)=>`\u0192${e?` ${e}`:""}\u27EA${o}\u27EB`,NUMERIC:e=>typeof e=="bigint"?`BigInt\u27EA${e}\u27EB`:`Number\u27EA${e}\u27EB`},t={NO_CONNECTION:"Could not establish connection. Receiving end does not exist.",PORT_CLOSED:"The message port closed before a response was received.",QUOTA_EXCEEDED:"QUOTA_BYTES quota exceeded"};function i(e,o){return function(s){s.source===window&&typeof s.data=="object"&&s.data!==null&&(s.data.source==="jsdiff-console-to-proxy-inprogress"?e(s):s.data.source==="jsdiff-console-to-proxy-compare"&&o(s))}}async function c(e){const o=e.data.payload,{lastApiReq:s}=await chrome.storage.local.get(["lastApiReq"]),p=E(s,o);try{await chrome.storage.local.set({lastApiReq:p,lastError:""}),chrome.runtime.sendMessage({source:"jsdiff-proxy-to-panel-compare"},r)}catch(a){a?.message===t.QUOTA_EXCEEDED?(await chrome.storage.local.set({lastError:t.QUOTA_EXCEEDED}),chrome.runtime.sendMessage({source:"jsdiff-proxy-to-panel-error"},r)):a?.message&&console.error("Unhnadled",a.message)}}function l(e){chrome.runtime.sendMessage({source:"jsdiff-proxy-to-panel-inprogress",on:e.data.on},r)}function E(e,o){e||(e={left:n.EMPTY,right:n.EMPTY,timestamp:Date.now()});const s=e;return Reflect.has(o,"push")?(s.left=s.right,s.right=o.push):(Reflect.has(o,"left")&&(s.left=o.left),Reflect.has(o,"right")&&(s.right=o.right)),s.timestamp=o.timestamp,s}function r(){f(chrome.runtime.lastError)||console.error(chrome.runtime.lastError)}function f(e){return!e||e.message===t.NO_CONNECTION||e.message===t.PORT_CLOSED}window.addEventListener("message",i(l,c))})();
